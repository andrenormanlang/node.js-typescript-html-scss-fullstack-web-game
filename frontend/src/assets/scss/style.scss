/* ========================================
   KILL THE VIRUS â€” Improved UI / UX
   ======================================== */

// ----- Variables -----
$bg:        #0a0e17;
$surface:   #141b2d;
$border:    #1e2a45;
$neon:      #39ff14;
$neon-dim:  rgba(57, 255, 20, .25);
$neon-glow: 0 0 8px rgba(57, 255, 20, .6);
$red:       #ff3b5c;
$gold:      #ffd700;
$white:     #e8eaf0;
$muted:     #7a8ba7;
$font:      'Orbitron', sans-serif;
$radius:    10px;
$transition: .25s ease;

// ----- Reset & base -----
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

html { font-size: 16px; }

body {
  font-family: $font;
  background: $bg;
  color: $white;
  height: 100vh;
  overflow: hidden;
  -webkit-font-smoothing: antialiased;
}

.hide { display: none !important; }

// ----- Shared button -----
.btn {
  font-family: $font;
  font-weight: 600;
  font-size: .85rem;
  border: none;
  border-radius: $radius;
  cursor: pointer;
  padding: .75rem 2rem;
  transition: $transition;
  text-transform: uppercase;
  letter-spacing: 1px;

  &-primary {
    background: $neon;
    color: $bg;
    box-shadow: $neon-glow;

    &:hover:not(:disabled) {
      background: lighten($neon, 8%);
      box-shadow: 0 0 16px rgba(57, 255, 20, .8);
      transform: translateY(-2px);
    }

    &:disabled {
      opacity: .5;
      cursor: not-allowed;
    }
  }
}

// ========================
//  LOBBY
// ========================
#lobby {
  display: flex;
  flex-direction: column;
  height: 100vh;
  overflow: hidden;
}

header {
  background: $surface;
  border-bottom: 2px solid $neon;
  padding: 1.25rem 2rem;
  text-align: center;

  .header-inner { max-width: 800px; margin: 0 auto; }

  h1 {
    font-size: 1.8rem;
    color: $neon;
    text-shadow: $neon-glow;
    margin-bottom: .25rem;

    .accent { color: $white; }
  }

  .tagline {
    color: $muted;
    font-size: .65rem;
    letter-spacing: 1px;
    font-weight: 400;
  }
}

main {
  flex: 1;
  max-width: 820px;
  width: 100%;
  margin: 0 auto;
  padding: 1rem 1rem clamp(3.5rem, 8vh, 5rem);
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: clamp(0.75rem, 1.5vh, 1.25rem);
  overflow-y: auto;
  overflow-x: hidden;

  @media (max-width: 700px) {
    grid-template-columns: 1fr;
    padding: 1rem 1rem 4rem;
  }
}

// ----- Cards -----
.card {
  background: $surface;
  border: 1px solid $border;
  border-radius: $radius;
  padding: clamp(1rem, 2vh, 1.5rem);
  transition: border-color $transition;

  &:hover { border-color: $neon-dim; }

  h2 {
    font-size: .85rem;
    margin-bottom: clamp(0.5rem, 1.5vh, 1rem);
    color: $neon;
    display: flex;
    align-items: center;
    gap: .5rem;

    i { font-size: 1rem; }
  }
}

.join-card {
  grid-column: 1 / -1;
  text-align: center;
}

// ----- Form -----
#username-form {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: .75rem;
}

#username-input {
  font-family: $font;
  font-size: .8rem;
  background: $bg;
  border: 2px solid $border;
  border-radius: $radius;
  height: 48px;
  width: 260px;
  padding: 0 1rem;
  color: $white;
  outline: none;
  transition: border-color $transition;

  &::placeholder { color: $muted; }
  &:focus { border-color: $neon; box-shadow: $neon-glow; }
}

// ----- Waiting spinner -----
#waiting-msg {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: .75rem;
  margin-top: 1rem;

  p { color: $muted; font-size: .7rem; }
}

.pulse-ring {
  width: 20px;
  height: 20px;
  border: 3px solid $neon;
  border-radius: 50%;
  animation: pulse-ring 1.2s ease-out infinite;
}

@keyframes pulse-ring {
  0%   { transform: scale(.6); opacity: 1; }
  100% { transform: scale(1.6); opacity: 0; }
}

// ----- Records -----
.records-card {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 1fr;
  gap: .5rem;

  h2 { grid-column: 1 / -1; }
}

.record-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  background: $bg;
  padding: .6rem 1rem;
  border-radius: 6px;
  font-size: .7rem;
}

.record-label { color: $muted; }
.record-value { color: $gold; font-weight: 600; }

// ----- Game lists -----
.game-list {
  list-style: none;
  display: flex;
  flex-direction: column;
  gap: .4rem;

  li {
    background: $bg;
    border: 1px solid $border;
    border-radius: 6px;
    padding: .5rem .75rem;
    font-size: .65rem;
    text-align: center;
    transition: border-color $transition;
    animation: fadeSlideIn .3s ease;

    &:hover { border-color: $neon-dim; }
  }
}

.empty-hint {
  color: $muted;
  font-size: .6rem;
  text-align: center;
  padding: .5rem 0;
}

@keyframes fadeSlideIn {
  from { opacity: 0; transform: translateY(8px); }
  to   { opacity: 1; transform: translateY(0); }
}

// ==========================
//  GAME
// ==========================
#game {
  display: none;
  flex-direction: column;
  height: 100vh;
  background: $bg;
}

.game-topbar {
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: .75rem 1.5rem;
  border-bottom: 2px solid $neon;
  background: $surface;

  .round-badge {
    position: absolute;
    left: 1.5rem;
    font-size: .65rem;
    background: $neon-dim;
    color: $neon;
    padding: .35rem .9rem;
    border-radius: 20px;
    letter-spacing: 1px;
  }

  .game-title {
    font-size: 1.1rem;
    color: $neon;
    text-shadow: $neon-glow;
  }
}

// ----- Countdown overlay -----
.countdown-overlay {
  position: absolute;
  inset: 0;
  background: rgba($bg, .85);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 100;

  #countdown-number {
    font-size: 5rem;
    color: $neon;
    text-shadow: 0 0 30px $neon;
    animation: countPop .5s ease;
  }
}

@keyframes countPop {
  0%   { transform: scale(2); opacity: 0; }
  60%  { transform: scale(.9); opacity: 1; }
  100% { transform: scale(1); }
}

// ----- Game play layout -----
.gamePlay {
  display: flex;
  flex: 1;
  overflow: hidden;

  @media (max-width: 768px) {
    flex-direction: column;
  }
}

#gameboard {
  flex: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
  padding: clamp(0.5rem, 2vh, 1rem);
  overflow: hidden;
}

#gameScreen {
  width: min(90vmin, 650px);
  height: min(90vmin, 650px);
  background: $surface;
  border: 2px solid $border;
  border-radius: $radius;
  display: grid;
  grid-template-columns: repeat(10, 1fr);
  grid-template-rows: repeat(10, 1fr);
  gap: 2px;
  justify-items: center;
  align-items: center;
  transition: border-color $transition;
  cursor: crosshair;

  &:hover { border-color: $neon-dim; }
}

// ----- Virus -----
.virus {
  font-size: clamp(2rem, 4vw, 3.5rem);
  cursor: pointer;
  filter: drop-shadow(0 0 8px rgba(57, 255, 20, .5));
  animation: virusPulse .6s ease-in-out infinite alternate, virusWobble 1.2s ease-in-out infinite;
  user-select: none;
  transition: transform .1s;

  &:hover {
    transform: scale(1.25);
    filter: drop-shadow(0 0 14px $neon);
  }

  &:active {
    transform: scale(.85);
  }
}

@keyframes virusPulse {
  from { transform: scale(1); }
  to   { transform: scale(1.15); }
}

@keyframes virusWobble {
  0%, 100% { rotate: -5deg; }
  50%      { rotate: 5deg; }
}

// ----- Explosion on click -----
.explosion {
  font-size: 2.5rem;
  pointer-events: none;
  animation: explode .45s ease-out forwards;
}

@keyframes explode {
  0%   { opacity: 1; transform: scale(.5); }
  100% { opacity: 0; transform: scale(2.5); }
}

// ----- Early-click warning -----
.early-warn {
  position: absolute;
  bottom: 2rem;
  left: 50%;
  transform: translateX(-50%);
  background: $red;
  color: #fff;
  font-size: .7rem;
  padding: .4rem 1.2rem;
  border-radius: 20px;
  animation: shake .4s ease;
  z-index: 50;
}

// ----- Round result banner -----
.round-result {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: .85rem;
  font-weight: 700;
  padding: .6rem 2rem;
  border-radius: $radius;
  z-index: 60;
  pointer-events: none;
  animation: fadeSlideIn .3s ease;

  &.win {
    background: rgba($neon, .2);
    border: 2px solid $neon;
    color: $neon;
    text-shadow: $neon-glow;
  }

  &.lose {
    background: rgba($red, .2);
    border: 2px solid $red;
    color: $red;
  }
}

@keyframes shake {
  0%, 100% { translate: 0; }
  25%      { translate: -6px; }
  75%      { translate: 6px; }
}

// ----- Scoreboard -----
#scoreboard {
  width: 280px;
  background: $surface;
  border-left: 2px solid $border;
  display: flex;
  flex-direction: column;

  @media (max-width: 768px) {
    width: 100%;
    flex-direction: row;
    flex-wrap: wrap;
    border-left: none;
    border-top: 2px solid $border;
  }
}

.sb-section {
  padding: .75rem 1rem;
  text-align: center;
}

.sb-header {
  font-size: .75rem;
  letter-spacing: 2px;
  color: $muted;
  border-bottom: 1px solid $border;
}

.sb-score {
  font-size: 2rem;
  font-weight: 800;
  color: $white;
  padding: 1rem;
}

.sb-timer {
  display: flex;
  flex-direction: column;
  gap: .25rem;

  .timer-label {
    font-size: .55rem;
    color: $muted;
    text-transform: uppercase;
    letter-spacing: 1px;
  }

  .timer-value {
    font-size: 1.6rem;
    color: $neon;
    font-weight: 800;
    text-shadow: $neon-glow;
    font-variant-numeric: tabular-nums;
  }
}

.sb-players {
  flex: 1;
  display: flex;
  flex-direction: column;
  justify-content: center;
  gap: .5rem;
}

.player-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  background: $bg;
  padding: .5rem .75rem;
  border-radius: 6px;
  font-size: .65rem;
}

.player-name { color: $muted; }
.player-time { font-weight: 600; font-variant-numeric: tabular-nums; }

.you .player-time   { color: $neon; }
.opponent .player-time { color: $red; }

// ----- Round dots -----
.sb-round-dots {
  display: flex;
  justify-content: center;
  flex-wrap: wrap;
  gap: 6px;
  padding: .75rem 1rem;
}

.round-dot {
  width: 14px;
  height: 14px;
  border-radius: 50%;
  border: 2px solid $border;
  transition: $transition;

  &.win  { background: $neon;  border-color: $neon; box-shadow: 0 0 6px $neon; }
  &.lose { background: $red;   border-color: $red; }
  &.current { border-color: $neon; animation: dotBlink 1s ease infinite; }
}

@keyframes dotBlink {
  0%, 100% { opacity: 1; }
  50%      { opacity: .3; }
}

// ==========================
//  END GAME
// ==========================
#endGameBoard {
  display: none;
  align-items: center;
  justify-content: center;
  height: 100vh;
  padding: clamp(1rem, 3vh, 2rem);
  background: $bg;
  overflow-y: auto;
}

.end-card {
  background: $surface;
  border: 2px solid $neon;
  border-radius: $radius;
  padding: clamp(1.5rem, 4vh, 2.5rem);
  text-align: center;
  max-width: 540px;
  width: 100%;
  animation: fadeSlideIn .5s ease;
  box-shadow: 0 0 40px rgba(57,255,20,.1);
  margin: auto;
}

.trophy-icon {
  font-size: 4rem;
  margin-bottom: .5rem;
  animation: trophyBounce 1.5s ease infinite;
}

@keyframes trophyBounce {
  0%, 100% { transform: translateY(0); }
  50%      { transform: translateY(-10px); }
}

.winner-name {
  color: $gold;
  font-size: 1.6rem;
  margin-bottom: 1.5rem;
  text-shadow: 0 0 10px rgba(255,215,0,.4);
}

.end-stats {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 1rem;
  margin-bottom: 2rem;

  @media (max-width: 500px) {
    flex-direction: column;
  }
}

.end-stat-block {
  background: $bg;
  border-radius: $radius;
  padding: 1rem 1.25rem;
  flex: 1;
  min-width: 160px;

  h3 {
    font-size: .7rem;
    margin-bottom: .5rem;
    color: $muted;
  }

  p {
    font-size: .65rem;
    margin-bottom: .3rem;
    color: $white;
  }
}

.you-block { border: 1px solid $neon-dim; }
.opp-block { border: 1px solid rgba($red, .25); }

.end-stat-divider {
  font-size: .75rem;
  color: $muted;
  font-weight: 800;
}

// ==========================
//  FOOTER
// ==========================
.footer {
  position: fixed;
  bottom: 0;
  width: 100%;
  height: clamp(40px, 6vh, 48px);
  display: flex;
  align-items: center;
  justify-content: center;
  background: $surface;
  border-top: 1px solid $border;
  z-index: 200;
  flex-shrink: 0;

  p {
    font-size: .5rem;
    color: $muted;
    letter-spacing: 2px;
  }
}

// ==========================
//  Font Awesome inline fix
// ==========================
.emoji {
  display: inline-block;
  animation: tilt .5s ease-in-out infinite alternate;
}

@keyframes tilt {
  from { transform: rotate(-10deg); }
  to   { transform: rotate(10deg); }
}
